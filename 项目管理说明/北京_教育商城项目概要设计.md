# 在线教育商城概要设计

## 设计目标

建设一个旨在为社会教育资源和面临升学问题的(孩子的)家庭建立一个互动,交流的网络平台. 充分利用社会教育资源为孩子提高学习成绩.为家长缓解孩子的教育压力.同时为提供在线教育的工作者提供灵活的就业方式和适当的报酬.

* 平台以**BS模式架构**, 方便用户在Pc端操作.同时**提供API接口**,为将来对微信公众号和App用户的扩展做好技术准备.
* 编程语言考虑**Java和Python**2者之一或者配合使用.Java是经过长期实践检验的,稳定和健壮的语言.适合编写各类Web和高并发服务端.Python即是著名的胶水语言(可以无缝的和任何语言混合使用),同时在人工智能领域处于统治地位(可以为将来引入AI模块做好技术准备)
* 数据库方面推荐**MySQL搭配MongoDB**使用.MySQL数据库在关系型数据库中是首选,可以方便的构建各种负责的事务关系.缺点是对于对象(图像,视频等)的保存.而MongoDB的是高并发的面向对象的数据库.存储对象(图像,视频等)是强项.可以很方便的实现分布式的图像和视频数据的集群,可以满足业务持续增长的需求而无需对系统架构作出改变.
  
## 模块划分

整个平台分2大部分: **后台管理**部分和**教育商城**部分, 共有3类账户与之相对应: 

* **管理员账户**属于后台管理部分, 操作的是后台管理页面.其权限如下:
  >1. **系统参数调整**:对平台的系统参数进行设置和调整: 比如: 设置课程,对班级的添加,删除和修改, 设置班级和老师, 班级和学生之间的关系. 
  >2. **账户信息管理** 家长/学生/老师 账户信息的增/删改, 启用禁用,导出/导入,聚合统计, 图表显示,等.
  >3. **订单信息管理** 平台订单信息的查看, 修改, 导出/导入,聚合统计, 图表显示,等.
  >4. **财务信息管理** 财务相关信息(分销信息)的查看, 修改, 导出/导入,聚合统计, 图表显示,等.
  >5. **后台账户管理** 平台管理员可以创建子账户.并分配不同的权限.(比如给财务人员分配对财务部分的访问和操作权限)
  >6. **商城管理** 商城首页的Banner管理. 首页搜索引擎的推荐关键字. 上首页的商品/老师的排序, 商城的广告等.
  >7. 其他需要在平台层面上的管理和修改的权限.

* **老师账户**操作的教育商城的老师中心页面
  >1. **试题管理**: 试题有多用种类,包括: 选择题, 填空题, 问答题(开放问题).也有多种的表现形式: 比如: 文本格式, 音频, 视频等. 老师可以自己发布/修改/下架自己的的试题,根据筛选条件进行查询. 或者按照指定的条件排序进行列表查看.
  >2. **订单管理**: 老师在这里查看自己的订单,修改订单状态(接受/取消)
  >3. **收支管理**: 包含订单的收入和分销的收入,可以以多种方式查询,排序和汇总等.
  >4. **个人信息**: 老师个人相关的信息的修改.比如头像,简介等.

* **学生账户**和**家长账户**都是在教育商城的用户模块.用户可以在商城首页登录,然后进行操作:
  >1. **用户中心**: 个人基础信息, 支付信息的管理. 账户关联, 余额查看, (分销)积分兑现等等
  >2. **收藏夹**: 用户感兴趣的东西都可以放入收藏夹.这里可以直接跳转到商品的详细页面进行查看和购买.如果这个商品已经购买过,对提供一个跳转到购物车里
  >3. **购物车**:  用户存放商品的容器.分为未购买和已购买部分. 对于未购买的试题可以选中付款;对于已购买的试题. 学生账户可以对试题进行解答,上传答案.查看答案, 或者向老师发出讲题的请求(订单).对于有付款需求的操作,会提示用户进行付款操作. 购物车内的试题可以进行自定义归类和标识(打标签): 未掌握,已掌握, 待讲解等 .
  >4. **教育商城**: 展示商品的主页面, 用户可以在此浏览和搜索商品.有轮播页面展示最新的活动和一些宣传信息, 用户可以按照年级和课程组合进行搜索.也可以使用关键字进行搜索(比如老师的名字).搜索栏附近是最近搜索靠前的几个热词的标签,方便进行快速搜索.

  ## 数据模型和算法逻辑

  ### 数据模型(部分)

用户模型(包含家长和学生)

```python
user = {
    "_id": "用户id,唯一,主键",
    "phone": "用户关联的手机号码",
    "user_name": "用户登录使用的用户名,唯一",
    "password": "用户登录时使用的密码",
    "type": "家长/学生,用于区分账户,对应不同的功能和权限",
    .....
}

```

试题/答案模型

```python
item = {
    "_id": "试题id,唯一,主键",
    "teacher_id": "老师的id",
    "level": "年级",
    "class": "学科",
    "title": "标题",
    "item_type": "试题还是答案?",
    "relate_id": "本试题/答案对应的答案/试题id",
    "content": "正文, 注意,这是一段富文本的内容,你可以看作是类似XML之类的语言书写的,可能包括图片,文本,视频,音频的内容"
    .....
}

```

购物车内记录模型

```python
cart_item = {
    "_id": "记录id,唯一,主键",
    "user_id": "用户id, 可以确定是哪个用户的购买记录",
    "item_id": "物品id,可以确认购买的是哪个试题/答案",
    "pay": "付款状态",
    "pay_time": "购买时间(付款后才有)",
    "price": "购买价格(付款后才有)",
    "create_time": "放入购物车时间"
}
```

收藏夹内记录模型

```python
cart_item = {
    "_id": "记录id,唯一,主键",
    "user_id": "用户id, 可以确定是哪个用户的购买记录",
    "item_id": "物品id,可以确认购买的是哪个试题/答案",
    "pay": "是否购买过?",
    "cart_record": "物品id,指向已购买的物品",
    "create_time": "放入收藏夹时间"
}
```

### 算法逻辑(部分)

> 对于复杂的数学公式的输入.我司有用在其他领域的解决方案. 可以考虑额外开发一个在线的数学公式输入接口.能够省下大量的硬盘空间(1200分辨率的一张图片大小超过4M,而表达同样内容的公式只有不到1k大小.占用空间是前者的几千分之一)和提高输入速度.如有需要,请和业务人员另行洽谈.输入的效果如下图所示:
> $$在线输入公式的示范: (\frac{\int_{0}^{+\infty}(\alpha+\beta)*\sum_{0}^{\epsilon^{+\infty}}}{\frac{\Omega\bigcup\Phi}{\sqrt{x+y}}})\times{1}\frac{1}{3}$$

#### 老师中心

##### 试题的上传

试题/答案为复合对象,可能包含多种格式数据.可能包含几种典型的格式如下:

* **文本格式**: 直接在页面输入,比如选择题填空题等.老师可以直接在线输入.也可以批量导入.批量导入时需要规范格式.以便系统按照格式进行识别. (格式识别使用Python或者R语言书写).导入之前应有一个预检测的功能.会标识出那些不符合格式要求的部分并提出改正意见.
* **图片格式**: 复杂的公式或其他不适合在线输入的试题,比如看图说话之类的试题. 需要上传图片.上传的图片以二进制或者Base64文件的形式保存在对象中.
* **音频格式**: 类似英语听力类的试题.可能需要音频文件来承载.文件本身保存在专用的数据服务器上,只讲超链接存储在对象中.
* **视频格式**: 需要记录一连串活动的画面的试题.保存方式和音频格式类似,都是数据本身和链接分开保存.

##### 答题

答题从抽象的角度来说,跟上传试题的操作很像. 使用的是同一个数据模型(但保存位置不同).答案本身也是一个符合对象.可能包含多种格式的文件.但也可能只是简单的文本.

##### 商城首页的搜索功能

商城的搜索应该可以组合**多种搜索条件**(默认是简单的搜索框),可以展开为高级搜索.在搜索栏输入文字或者点击搜索栏的时候,可以根据用户的输入进行模糊匹配提醒(用户输入为空或者没有输入时提示最近搜索比较多的几个关键词). 
搜索栏附近应有**热词**区域,热词是最近搜索频度比较高的热门词汇.也可能是平台有意推广的关键词. 作为搜索的快捷方式.点击即可搜索,无需再输入关键词.兼有快速搜索和推广2项功能.

商城的商品应搜索/浏览**推荐功能**.商城会记录用户的浏览/搜索记录. 会把相关年级/学科/关键词(兴趣点)商品放置到屏幕上用户视野的热点区域周边(侧边栏/页脚/minibanner等)位置.


