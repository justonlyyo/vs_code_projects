# PMS(编号P00)

## 100 单

## 200 房态

### 1000 房态种类设置：Code_sta

| API编号    | API名字            | 参数           | 调用方法：微服务/RPC/all | 说明                 |
| ---------- | ------------------ | -------------- | ------------------------ | -------------------- |
| P002001001 | Add_code_sta       |                |                          | 增加房态种类         |
| P002001002 | Dele_code_sta      |                |                          | 删除房态种类         |
| P002001003 | Update_code_sta    |                |                          | 修改房态种类         |
| P002001004 | Get_code_sta       | 传入房态种类ID |                          | 查询房态种类         |
| P002001005 | get_all_code_sta   |                |                          | 查询所有房态种类     |
| P002001006 | get_main_code_sta  |                |                          | 查询所有主房态种类   |
| P002001007 | get_extra_code_sta |                |                          | 查询所有扩展房态种类 |

![1550549585565](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1550549585565.png)

### 2000 占用状态设置：code_room_occ

| API编号    | API名字          | 参数           | 调用方法：微服务/RPC/all | 说明             |
| ---------- | ---------------- | -------------- | ------------------------ | ---------------- |
| P002002001 | Add_code_occ     |                |                          | 增加占用状态     |
| P002002002 | Dele_code_occ    |                |                          | 删除占用状态     |
| P002002003 | Update_code_occ  |                |                          | 修改占用状态     |
| P002002004 | Get_code_occ     | 传入占用状态ID |                          | 查询占用状态     |
| P002002005 | get_all_code_occ |                |                          | 查询所有占用状态 |

![1550549720615](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1550549720615.png)

### 3000 查房内容设置表 :code_room_check_content

| API编号    | API名字                               | 参数           | 调用方法：微服务/RPC/all | 说明                                        |
| ---------- | ------------------------------------- | -------------- | ------------------------ | ------------------------------------------- |
| P002003001 | Add_code_room_check_content           |                |                          | 增加房间查房内容                            |
| P002003002 | Dele_code_room_check_content          |                |                          | 删除房间查房内容                            |
| P002003003 | Update_code_room_check_content        |                |                          | 修改房间查房内容                            |
| P002003004 | Get_code_room_check_content           | 传入占用状态ID |                          | 查询房间查房内容                            |
| P002003005 | get_top_code_room_check_content       |                |                          | 查询所有顶级房间查房内容（顶级的parentid=0) |
| P002003005 | get_son_code_room_check_content       | 传入parentid   |                          | 查询下级房间查房内容                        |
| P002003005 | get_offspring_code_room_check_content | 传入parentid   |                          | 查询所有子孙房间查房内容                    |

![1550573366483](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1550573366483.png)

### 4000 查房记录表：room_check

| API编号    | API名字                | 参数                                   | 调用方法：微服务/RPC/all | 说明                                                         |
| ---------- | ---------------------- | -------------------------------------- | ------------------------ | ------------------------------------------------------------ |
| P002004001 | Add_room_check         |                                        |                          | 增加查房记录                                                 |
| P002004002 | Dele_room_check        |                                        |                          | 删除查房记录                                                 |
| P002004003 | Update_room_check      |                                        |                          | 修改查房记录                                                 |
| Q002004004 | Get_room_check_info    | 传入房号，某个截止时间（默认当前时间） |                          | 得到传入的时间之前最后一次的查房记录信息,包括下面detail表里面的查房区域\分数\评价的三维数组 |
| Q002004005 | Get_done_checker       | 传入房号，某个截止时间（默认当前时间） |                          | 得到传入时间之前的最后一次的查房人id                         |
| Q002004006 | get_today_checked_room |                                        |                          | 得到所有今天查房的房间号id数组                               |

数据库：

![1550551152196](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1550551152196.png)

### 5000 查房细节表：room_check_detail

| API编号    | API名字                | 参数                                                 | 调用方法：微服务/RPC/all | 说明                                                 |
| ---------- | ---------------------- | ---------------------------------------------------- | ------------------------ | ---------------------------------------------------- |
| Q002005001 | Add_check_details      | 传入房号，查房细节的三维数组（查房内容、份数、评价） |                          | 增加一套查房细节                                     |
| Q002005002 | Dele_check_details     | 传入房号，时间                                       |                          | 删除这个房号传入时间之前的最后一次的所有查房细节     |
| Q002005003 | Update_check_details   | 传入房号，时间                                       |                          | 修改这个房号传入时间之前的最后一次的所有查房细节     |
| Q002005004 | Get_check_details      | 传入房号，时间                                       |                          | 得到这个房号传入时间之前的最后一次的所有查房细节     |
| Q002005005 | Get_check_detai_labled | 传入一个完成标志参数                                 |                          | 得到这个标志值的所有查房细节信息数组                 |
| Q002005006 | Get_under_score_check  | 传入一个分数值，日期（默认今天）                     |                          | 得到所有指定日期低于等于这个分数值的所有查房信息数组 |

数据库：

![1550551309712](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1550551309712.png)



### 6000 房间_房态表 : room _ sta

（排放后修改指定房号的房态）

| API编号    | API名字                     | 参数                               | 调用方法：微服务/RPC/all | 说明                                                         |
| ---------- | --------------------------- | ---------------------------------- | ------------------------ | ------------------------------------------------------------ |
| P002006001 | Creat_room_sta              | 传入酒店id，集团id                 |                          | 生成房态表（每个房间房号一条记录）                           |
| P002006002 | add_room_sta_sub_account    | 传入房号id，房号，子账户信息       |                          | 增加一个账户的分账户                                         |
| P002006003 | dele_room_sta_sub_account   | 传入房号，分账户号                 |                          | 删除一个账户的某个分账户                                     |
| P002006004 | Update_room_sta             |                                    |                          | 修改一条房态信息                                             |
| P002006005 | update_room_sta_sub_account | 传入房号id，房号，子账户信息       |                          | 修改一个账户的某个分账户信息                                 |
| P002006006 | Get_room_sta                | 传入房号                           |                          | 查询一个房间的房态信息（包括老的房态，新的房态，临时态，锁定房态，未来房态以及相应的起止时间） |
| P002006007 | get_room_sta_accounts       | 传入房号id,房号，                  |                          | 得到一个房间所有的分账户信息                                 |
| P002006008 | get_rooms_by_sta            | 传入一个需要查询的房态id，指定时间 |                          | 得到所有的目前房态为指定房态的房间号                         |

数据库：



![1550575615648](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1550575615648.png)

### 7000 房间_ 占用表：room_occ

将单和房型联系起来，有单之后就生成一条记录，

| API编号    | API名字                  | 参数                           | 调用方法：微服务/RPC/all | 说明                                                         |
| ---------- | ------------------------ | ------------------------------ | ------------------------ | ------------------------------------------------------------ |
| P002007001 | Add_Room_occ             | 传入单信息，一种房型一条记录   |                          | 增加房间占用记录                                             |
| P002007002 | Dele_Room_occ            | 传入房间占用记录id             |                          | 删除房间占用记录(对于订单取消的情况)                         |
| P002007003 | Update_Room_occ          | 传入房间占用记录id，           |                          | 修改房间占用记录                                             |
| P002007004 | Arrange_rooms            | 传入房间占用记录id，           |                          | 排房操作                                                     |
| P002007005 | is_arranged              | 传入单号，入住还是预定的标志量 |                          | 返回是否已经排房的信息（0：未排房，1：部分排房，2：完全排房） |
| P002007006 | Get_Accounts_by_roomtype | 传入房型id,时间段              |                          | 根据房型获得指定时间内所有占用的账号信息或单号信息           |

数据库：

![1550579626468](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1550579626468.png)

### 8000 房间_房态变化表：room _ sta _ chg

| API编号    | API名字               | 参数                                       | 调用方法：微服务/RPC/all | 说明                                                         |
| ---------- | --------------------- | ------------------------------------------ | ------------------------ | ------------------------------------------------------------ |
| Q001001001 | get_room_sta_chg_list | 传入房号ID，开始时间段（默认今天）         |                          | 查询某个房号的指定时间段向前创建的最后一条记录的房态变化记录list |
| Q001001002 | updatet_room_sta      | 传入房号ID，改变房态信息，同步写入room_sta |                          | 修改房态                                                     |



![1550552900968](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1550552900968.png)



### 9000 房间_当前房态图： room_map

| API编号    | API名字              | 参数                 | 调用方法：微服务/RPC/all | 说明                               |
| ---------- | -------------------- | -------------------- | ------------------------ | ---------------------------------- |
| Q001001001 | Add_extra_room_sta   | 传入房号，扩展房态id |                          | 增加扩展房态                       |
| Q001001002 | dele_extra_room_sta  | 传入房号，扩展房态id |                          | 删除扩展房态                       |
| Q001001003 | change_main_room_sta | 传入房号，主房态id   |                          | 修改主房态                         |
| Q001001004 | get_room_sta         | 传入房号             |                          | 查询该房间的所有房态List           |
| Q001001005 | get_rooms_by_sta     | 传入房态类型id,时间  |                          | 获得所有指定时间这种房态的房间LIst |



数据库：

![1550553118919](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1550553118919.png)

## 300 房情




